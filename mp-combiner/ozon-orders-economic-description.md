# –ü–æ—è—Å–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π –≤ –∑–∞–ø—Ä–æ—Å–µ —ç–∫–æ–Ω–æ–º–∏–∫–∏ –∑–∞–∫–∞–∑–æ–≤ –û–∑–æ–Ω

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–∫–∞–∑–∞

| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------|----------|------------|--------|
| **posting_number** | `fbs_order.posting_number` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è –û–∑–æ–Ω | "0100169990-0103-1" |
| **posting_number_short** | –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–µ–∑–∫–∏ | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ–¥–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞ | "0100169990-0103" |
| **order_id** | `fbs_order.order_id` | ID –∑–∞–∫–∞–∑–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –û–∑–æ–Ω | "28537586406" |
| **order_number** | `fbs_order.order_number` | –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –Ω–æ–º–µ—Ä |

## üìä –°—Ç–∞—Ç—É—Å –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è |
|------|----------|------------|-------------------|
| **order_status** | `fbs_order.status` | –°—Ç–∞—Ç—É—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è | delivered, cancelled, awaiting_packaging |
| **order_date** | `fbs_order.in_process_at` | –î–∞—Ç–∞ –ø—Ä–∏–Ω—è—Ç–∏—è –∑–∞–∫–∞–∑–∞ –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É | 2024-01-11T20:43:21.000Z |
| **shop_name** | `fbs_order.shop_name` | –ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞ | "GetPwr" |
| **region** | `posting_analytics_data.region` | –†–µ–≥–∏–æ–Ω –¥–æ—Å—Ç–∞–≤–∫–∏ | "–ú–æ—Å–∫–≤–∞ –∏ –æ–±–ª–∞—Å—Ç—å" |

## üõçÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–∞—Ö

| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------|----------|------------|--------|
| **sku** | `posting_product.sku` | SKU —Ç–æ–≤–∞—Ä–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –û–∑–æ–Ω | 1823748558 |
| **offer_id** | `posting_product.offer_id` | –ê—Ä—Ç–∏–∫—É–ª –ø—Ä–æ–¥–∞–≤—Ü–∞ | "1531" |
| **product_name** | `posting_product.name` | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ | "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä Li-ion 18650" |
| **quantity** | `posting_product.quantity` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–∞ –≤ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ | 1 |
| **product_price** | `posting_product.price` | –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞ | 590.00 |
| **unit_selfcost** | `ms_self_cost_data.selfcost` –∏–ª–∏ `posting_product.selfcost` | –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –µ–¥–∏–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–∞ | 125.00 |

## üí∞ –†–∞—Å—á–µ—Ç–Ω—ã–µ –ø–æ–ª—è –ø–æ —Ç–æ–≤–∞—Ä–∞–º

| –ü–æ–ª–µ | –§–æ—Ä–º—É–ª–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------|---------|------------|--------|
| **total_product_revenue** | `quantity * product_price` | –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ –æ—Ç —Ç–æ–≤–∞—Ä–∞ | 590.00 |
| **total_selfcost** | `quantity * unit_selfcost` | –û–±—â–∞—è —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ | 125.00 |

## üè™ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞

| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------|----------|------------|--------|
| **commission_percent** | `posting_fin_data_product.commission_percent` | –ü—Ä–æ—Ü–µ–Ω—Ç –∫–æ–º–∏—Å—Å–∏–∏ –û–∑–æ–Ω | 22 |
| **commission_amount** | `posting_fin_data_product.commission_amount` | –°—É–º–º–∞ –∫–æ–º–∏—Å—Å–∏–∏ (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è) | -147.5 |
| **payout** | `posting_fin_data_product.payout` | –í—ã–ø–ª–∞—Ç–∞ –ø—Ä–æ–¥–∞–≤—Ü—É –æ—Ç –û–∑–æ–Ω | 1131 |
| **total_discount_value** | `posting_fin_data_product.total_discount_value` | –†–∞–∑–º–µ—Ä —Å–∫–∏–¥–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä | 1450 |

## üöö –£—Å–ª—É–≥–∏ –ª–æ–≥–∏—Å—Ç–∏–∫–∏ (–¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è)

| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ JSON | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –¢–∏–ø —Ä–∞—Å—Ö–æ–¥–∞ |
|------|---------------|------------|-------------|
| **service_pickup** | `item_services.marketplace_service_item_pickup` | –ó–∞–±–æ—Ä —Ç–æ–≤–∞—Ä–∞ —Å–æ —Å–∫–ª–∞–¥–∞ | –õ–æ–≥–∏—Å—Ç–∏–∫–∞ |
| **service_delivery** | `item_services.marketplace_service_item_deliv_to_customer` | –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é | –õ–æ–≥–∏—Å—Ç–∏–∫–∞ |
| **service_fulfillment** | `item_services.marketplace_service_item_fulfillment` | –£—Å–ª—É–≥–∏ —Ñ—É–ª—Ñ–∏–ª–º–µ–Ω—Ç–∞ | –õ–æ–≥–∏—Å—Ç–∏–∫–∞ |
| **service_return** | `item_services.marketplace_service_item_return_flow_trans` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ | –õ–æ–≥–∏—Å—Ç–∏–∫–∞ |
| **total_services_cost** | –°—É–º–º–∞ –≤—Å–µ—Ö service_* | –û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —É—Å–ª—É–≥–∏ | –ò—Ç–æ–≥–æ –ª–æ–≥–∏—Å—Ç–∏–∫–∞ |

## üí∏ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—é

| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è |
|------|----------|------------|---------------|
| **transaction_revenue** | `ozon_fin_transaction` | –î–æ—Ö–æ–¥—ã –æ—Ç –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π | SUM(amount > 0) |
| **transaction_commission** | `ozon_fin_transaction` | –ö–æ–º–∏—Å—Å–∏–æ–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã | SUM(WHERE operation_type_name LIKE '%–∫–æ–º–∏—Å—Å–∏—è%') |
| **transaction_logistics** | `ozon_fin_transaction` | –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–¥—ã | SUM(WHERE operation_type_name LIKE '%–¥–æ—Å—Ç–∞–≤–∫–∞%') |
| **transaction_bonus** | `ozon_fin_transaction` | –†–∞—Å—Ö–æ–¥—ã –Ω–∞ –±–æ–Ω—É—Å—ã | SUM(WHERE operation_type_name LIKE '%–±–æ–Ω—É—Å%') |
| **transaction_promotion** | `ozon_fin_transaction` | –†–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ | SUM(WHERE operation_type_name LIKE '%–ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏%') |
| **transaction_total_expenses** | `ozon_fin_transaction` | –í—Å–µ —Ä–∞—Å—Ö–æ–¥—ã –ø–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º | SUM(amount < 0) |

## üìà –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–ö–ü–≠)

| –ü–æ–ª–µ | –§–æ—Ä–º—É–ª–∞ | –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|------|---------|-------------------|------------|
| **gross_profit** | `–≤—ã—Ä—É—á–∫–∞ - —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å` | –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å | –ë–∞–∑–æ–≤–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ |
| **operating_profit** | `–≤–∞–ª–æ–≤–∞—è_–ø—Ä–∏–±—ã–ª—å - –∫–æ–º–∏—Å—Å–∏–∏ - —É—Å–ª—É–≥–∏` | –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å | –ü—Ä–∏–±—ã–ª—å –ø–æ—Å–ª–µ —Ä–∞—Å—Ö–æ–¥–æ–≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ |
| **net_profit** | `–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è_–ø—Ä–∏–±—ã–ª—å - –±–æ–Ω—É—Å—ã - –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ` | –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å | –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞ |
| **profit_margin_percent** | `(—á–∏—Å—Ç–∞—è_–ø—Ä–∏–±—ã–ª—å / –≤—ã—Ä—É—á–∫–∞) * 100` | –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –≤ % | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–æ–≤ |

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------|----------|------------|--------|
| **operation_types_count** | `COUNT(DISTINCT operation_type)` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∏–ø–æ–≤ –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ –∑–∞–∫–∞–∑—É | 5 |
| **operation_types** | `STRING_AGG(operation_type_name)` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –æ–ø–µ—Ä–∞—Ü–∏–π | "–î–æ—Å—Ç–∞–≤–∫–∞; –ö–æ–º–∏—Å—Å–∏—è; –ë–æ–Ω—É—Å—ã" |
| **delivery_date_begin** | `posting_analytics_data.delivery_date_begin` | –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ | 2024-01-12 |
| **delivery_date_end** | `posting_analytics_data.delivery_date_end` | –ö–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ | 2024-01-15 |

## üí° –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞—Å—á–µ—Ç–æ–≤

### üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –¥–∞–Ω–Ω—ã—Ö:
1. **–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å**: –ú–æ–π–°–∫–ª–∞–¥ ‚Üí posting_product ‚Üí 0
2. **–§–∏–Ω–∞–Ω—Å—ã**: posting_fin_data_product ‚Üí ozon_fin_transaction
3. **–£—Å–ª—É–≥–∏**: item_services (–¥–µ—Ç–∞–ª—å–Ω–æ) ‚Üí transaction_summary (–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ)

### üìä –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–±—ã–ª–∏:
```
–í—ã—Ä—É—á–∫–∞ (590‚ÇΩ)
‚îú‚îÄ –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (-125‚ÇΩ)
‚îî‚îÄ –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å (465‚ÇΩ)
   ‚îú‚îÄ –ö–æ–º–∏—Å—Å–∏—è –û–∑–æ–Ω (-147.5‚ÇΩ)
   ‚îú‚îÄ –£—Å–ª—É–≥–∏ –ª–æ–≥–∏—Å—Ç–∏–∫–∏ (-0‚ÇΩ)
   ‚îî‚îÄ –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å (317.5‚ÇΩ)
      ‚îú‚îÄ –ë–æ–Ω—É—Å—ã (-3.15‚ÇΩ)
      ‚îú‚îÄ –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ (-0‚ÇΩ)
      ‚îî‚îÄ –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å (314.35‚ÇΩ)
         ‚îî‚îÄ –†–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: 53.3%
```

### üîÑ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- **posting_number**: `"0100169990-0103-1"` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- **posting_number_short**: `"0100169990-0103"` - –≥—Ä—É–ø–ø–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–º—É –∑–∞–∫–∞–∑—É

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
1. **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è** –≤ –∫–æ–º–∏—Å—Å–∏—è—Ö –∏ —É—Å–ª—É–≥–∞—Ö –±–µ—Ä—É—Ç—Å—è –ø–æ –º–æ–¥—É–ª—é (`ABS()`)
2. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –ø–æ posting_number
3. **COALESCE** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ NULL –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö
4. **–ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤** `::NUMERIC` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã `ROUND()`